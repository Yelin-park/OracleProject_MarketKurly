# Oracle Data Base Project - MarketKurly
<p align="center">
  <br>
  <img src="images/marketkurly_1.PNG">
  <br>
</p>

<br>

## π“ƒλ©μ°¨
1. ν”„λ΅μ νΈ μ†κ°
2. DB λ¨λΈλ§
3. κµ¬ν„ κΈ°λ¥
4. λλ‚€μ 

<br><br>

## 1. ν”„λ΅μ νΈ μ†κ°

### ν”„λ΅μ νΈ λ™κΈ°/κ°μ”
- μµκ·Ό μΈκΈ°κ°€ λ§κ³  μ‚¬μ©μκ°€ λ§μ€ e-commerceλ¥Ό κΈ°μ¤€μΌλ΅ μ°Ύλ‹¤ λ§μΌ“μ»¬λ¦¬λ¥Ό μ„ μ •ν•κ² λμ—μµλ‹λ‹¤. <br>
- λ§μΌ“μ»¬λ¦¬ ν™νμ΄μ§€λ¥Ό μ§μ ‘ μ΄μ©ν•λ©° μ”κµ¬λ¶„μ„μ„ μ§„ν–‰ν•μ€μµλ‹λ‹¤. <br>
- μ”κµ¬λ¶„μ„ ν›„ κ°λ…μ , λ…Όλ¦¬μ , λ¬Όλ¦¬μ  λ¨λΈλ§μ„ μ§„ν–‰ν•μ€μµλ‹λ‹¤. <br>
- 4λ…μ ν€μ›μ΄ μ—…λ¬΄λ¥Ό λ¶„λ‹΄ν•μ—¬ κ°μ λ§΅μ€ λ¶€λ¶„μ— λ€ν•μ—¬ ν”„λ΅μ‹μ €, νΈλ¦¬κ±° λ“± μΏΌλ¦¬λ¥Ό μ‘μ„±ν•μ—¬ κΈ°λ¥μ„ κµ¬ν„ν•μ€μµλ‹λ‹¤. (PL/SQL μ‚¬μ©)<br>

<br>

### π”¨ κΈ°μ  μ¤νƒ
- <img src="https://img.shields.io/badge/-ORACLE-F80000?style=for-the-badge&logo=oracle">
- <img src="https://img.shields.io/badge/-draw.io-181717?style=for-the-badge&logo">
- <img src="https://img.shields.io/badge/-exERD-181717?style=for-the-badge&logo">
- <img src="https://img.shields.io/badge/-SQL Developer-181717?style=for-the-badge&logo">

<br>

### π‘ ν€μ›
- κΉ€λ―Ό
- λ―Όμ¤κΈ°
- λ°•μλ¦°
- λ°±κ²½ν™

<br><br>

## 2. DB λ¨λΈλ§
### π“ κ°λ…μ  DB λ¨λΈλ§
<p align="center">
  <br>
  <img src="images/marketkurly_ERD.png">
  <br>
</p>

<br>

### π“ λ…Όλ¦¬μ /λ¬Όλ¦¬μ  DB λ¨λΈλ§
<p align="center">
  <br>
  <img src="images/marketkurly_eXERD.png">
  <br>
</p>

<br><br>

## 3. κµ¬ν„ κΈ°λ¥
### μƒν’ κ΄€λ ¨
- μƒν’ μƒμ„Ένμ΄μ§€ λ“±λ΅
- μƒν’ μ΄λ―Έμ§€ λ“±λ΅
- μƒν’ λ“±λ΅

### κ΄€λ¦¬μ κ΄€λ ¨
- μ—…μ²΄ λ“±λ΅
- μ§μ› λ“±λ΅
- μΏ ν° λ“±λ΅
- μΏ ν° λ°κΈ‰
- νΉκ°€, ννƒ λ“±λ΅
- νμ› νƒν‡΄

<br>

## 3-1. κµ¬ν„ κΈ°λ¥ μΏΌλ¦¬
### [μƒν’ λ“±λ΅ κ΄€λ ¨]
- μƒν’ μ΄λ―Έμ§€μ™€ μƒμ„Ένμ΄μ§€λ” μƒν’ μ½”λ“λ¥Ό μ°Έμ΅°ν•κ³  μμ–΄ μƒν’μ΄ μ΅΄μ¬ν•΄μ•Ό λ“±λ΅μ΄ κ°€λ¥
- μƒν’ μƒμ„Ένμ΄μ§€μ—μ„ μƒμ„Ένƒ€μ…μ€ μ„¤λ…, μ•λ λ¥΄κΈ°μ •λ³΄, μμ–‘μ •λ³΄, μ›μ‚°μ§€λ§ μ…λ ¥μ΄ κ°€λ¥
- μƒν’ λ“±λ΅μ‹ μ΄λ―Έμ§€μ™€ μƒμ„Ένμ΄μ§€ λ“±λ΅μ΄ κ°€λ¥
- μƒν’ λ“±λ΅μ‹ κ°€κ²©μ€ 0μ› μ΄μƒ, λ‚©ν’μ—…μ²΄, μΉ΄ν…κ³ λ¦¬, νΉκ°€ννƒ μ½”λ“λ¥Ό μ°Έμ΅°ν•κ³  μκΈ°μ— ν•΄λ‹Ή μ½”λ“κ°€ μ—†μΌλ©΄ λ“±λ΅μ΄ λ¶κ°€λ¥
- μƒν’ λ“±λ΅μ‹ μƒμ¨, λƒ‰μ¥, λƒ‰λ™μΌλ΅ κµ¬λ¶„μ΄ λμ–΄ λ“±λ΅
- μƒν’ λ“±λ΅μ‹ ν• μΈκ°€λ” 0.00 ~ 1.00(0% ~ 100%) μ‚¬μ΄μ κ°’μΌλ΅λ§ λ“±λ΅μ΄ κ°€λ¥

<br>

- μƒν’ μ΄λ―Έμ§€ λ“±λ΅
~~~
1) μƒν’ μ΄λ―Έμ§€ μ½”λ“ μ‹ν€€μ¤ μƒμ„±

CREATE SEQUENCE seq_mk_productimg_code
INCREMENT BY 1
START WITH 31
NOMAXVALUE
MINVALUE 1
NOCYCLE;

-----------------------------------------------
2) μƒν’ μ΄λ―Έμ§€ λ“±λ΅ ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_productimg
(
    pP_CODE product_img.p_code%TYPE
    , pFILE_PATH product_img.file_path%TYPE
)
IS
    vP_CODE product_img.p_code%TYPE;
    
    e_null_productimg EXCEPTION;
    PRAGMA EXCEPTION_INIT (e_null_productimg, -01400);
    
BEGIN
    SELECT p_code INTO vP_CODE
    FROM product
    WHERE p_code = pP_CODE;

    INSERT INTO product_img VALUES (seq_mk_productimg_code.nextval, pP_CODE, pFILE_PATH);
  
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'μƒν’ μ½”λ“κ°€ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.');
    WHEN e_null_productimg THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.'); -- ν•„μμ…λ ¥ μ‚¬ν•­ ν™•μΈ         
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'μƒν’ μ΄λ―Έμ§€ λ“±λ΅μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

- μƒν’ μƒμ„Ένμ΄μ§€ λ“±λ΅
~~~
1) μƒν’ μƒμ„Ένμ΄μ§€ μ½”λ“ μ‹ν€€μ¤ μƒμ„±

CREATE SEQUENCE seq_mk_productdetail_code
INCREMENT BY 1
START WITH 11
NOMAXVALUE
MINVALUE 1
NOCYCLE;

-----------------------------------------------
2) μƒν’ μƒμ„Ένμ΄μ§€ λ“±λ΅ ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_productdetail
(
    pP_CODE product_detail.P_CODE%TYPE
    , pPD_TYPE product_detail.PD_TYPE%TYPE
    , pPD_CONTENT product_detail.PD_CONTENT%TYPE
)
IS
    vPD_TYPE product_detail.PD_TYPE%TYPE;
    
    e_no_pd_type EXCEPTION;
    e_null_productdetail EXCEPTION;
    e_no_pcode EXCEPTION;
    PRAGMA EXCEPTION_INIT (e_null_productdetail, -01400);
    PRAGMA EXCEPTION_INIT (e_no_pcode, -02291);
    
BEGIN
    IF pPD_TYPE IN ('μ„¤λ…', 'μ•λ λ¥΄κΈ°μ •λ³΄', 'μμ–‘μ •λ³΄', 'μ›μ‚°μ§€') THEN
        vPD_TYPE := pPD_TYPE;
    ELSE
        RAISE e_no_pd_type;
    END IF;

    INSERT INTO product_detail VALUES (seq_mk_productdetail_code.nextval, pP_CODE, vPD_TYPE, pPD_CONTENT);
    COMMIT;
    
EXCEPTION
    WHEN e_no_pcode THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'μƒν’ μ½”λ“κ°€ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.');
    WHEN e_no_pd_type THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20009, 'μƒμ„Ένƒ€μ…μ€ μ„¤λ…, μ•λ λ¥΄κΈ°μ •λ³΄, μμ–‘μ •λ³΄, μ›μ‚°μ§€λ§ μ…λ ¥μ΄ κ°€λ¥ν•©λ‹λ‹¤.');        
    WHEN e_null_productdetail THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');         
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'μƒν’ μƒμ„Ένμ΄μ§€ λ“±λ΅μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

- μƒν’ λ“±λ΅
~~~
1) μƒν’ μ½”λ“ μ‹ν€€μ¤ μƒμ„±

CREATE SEQUENCE seq_mk_product_code
INCREMENT BY 1
START WITH 11
NOMAXVALUE
MINVALUE 1
NOCYCLE;

--------------------------------------------------
2) μƒν’ λ“±λ΅ μ €μ¥ ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_product
(
    pP_NAME product.p_name%TYPE
    , pP_PRICE product.P_PRICE%TYPE
    , pP_DISCOUNT product.P_DISCOUNT%TYPE
    , pP_DETAIL product.P_DETAIL%TYPE
    , pP_COLD_TYPE product.P_COLD_TYPE%TYPE
    , pV_CODE product.V_CODE%TYPE
    , pCTGR_CODE product.CTGR_CODE%TYPE
    , pB_CODE product.B_CODE%TYPE
    , pP_RDATE product.P_RDATE%TYPE
    , pPATH product_img.file_path%TYPE -- μƒν’μ΄λ―Έμ§€κ²½λ΅ νλΌλ―Έν„°
    , pPD_TYPE product_detail.PD_TYPE%TYPE -- μƒν’μƒμ„Ένμ΄μ§€νƒ€μ… νλΌλ―Έν„°
    , pPD_CONTENT product_detail.PD_CONTENT%TYPE -- μƒν’μƒμ„Ένμ΄μ§€λ‚΄μ© νλΌλ―Έν„°
)
IS
    vP_DETAIL product.P_DETAIL%TYPE;
    vV_CODE product.V_CODE%TYPE;
    vB_CODE product.B_CODE%TYPE;
    vP_PRICE product.P_PRICE%TYPE;
    vP_DISCOUNT product.P_DISCOUNT%TYPE;
    vTOTAL_SALES product.TOTAL_SALES%TYPE := 0;
    
    e_no_code EXCEPTION;
    e_null_product EXCEPTION;
    e_cold_type EXCEPTION;
    e_price EXCEPTION;
    e_discount EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_no_code, -02291);
    PRAGMA EXCEPTION_INIT(e_null_product, -01400);
    PRAGMA EXCEPTION_INIT(e_cold_type, -02290);
BEGIN
    
    IF pP_DETAIL IS NOT NULL THEN
        vP_DETAIL := pP_DETAIL;
    ELSE vP_DETAIL := null;
    END IF;
    
    IF pV_CODE IS NOT NULL THEN
        vV_CODE := pV_CODE;
    ELSE vV_CODE := null;
    END IF;
    
    IF pB_CODE IS NOT NULL THEN
        vB_CODE := pB_CODE;
    ELSE vB_CODE := null;
    END IF;
    
    IF pP_price >= 0 THEN
        vP_PRICE := pP_price;
    ELSE
        RAISE e_price;
    END IF;
    
    IF pP_DISCOUNT BETWEEN 0 AND 1 THEN
        vP_DISCOUNT := pP_DISCOUNT;
    ELSE 
        RAISE e_discount;
    END IF;

    INSERT INTO product (P_CODE, P_NAME, P_PRICE, P_DISCOUNT, P_DETAIL, P_COLD_TYPE, V_CODE, CTGR_CODE, B_CODE, P_RDATE, TOTAL_SALES)
    VALUES (seq_mk_product_code.nextval, pP_NAME, vP_PRICE, pP_DISCOUNT, vP_DETAIL, pP_COLD_TYPE, vV_CODE, pCTGR_CODE, vB_CODE, pP_RDATE, vTOTAL_SALES);
    COMMIT;
        
    MK_P_PRODUCTIMG(seq_mk_product_code.currval, pPATH); -- μƒν’ μ΄λ―Έμ§€ λ“±λ΅ ν”„λ΅μ‹μ €
    MK_P_PRODUCTDETAIL(seq_mk_product_code.currval, pPD_TYPE, pPD_CONTENT); -- μƒν’ μƒμ„Ένμ΄μ§€ λ“±λ΅ ν”„λ΅μ‹μ €
    
EXCEPTION
    WHEN e_no_code THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'λ‚©ν’μ—…μ²΄ / μΉ΄ν…κ³ λ¦¬ / νΉκ°€ννƒ μ½”λ“κ°€ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.');
    WHEN e_null_product THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');
    WHEN e_cold_type THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20003, 'μƒμ¨1, λƒ‰μ¥2, λƒ‰λ™3μΌλ΅ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');
    WHEN e_price THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20005, 'κ°€κ²©μ€ 0μ› μ΄μƒμΌλ΅ μ…λ ¥ν•΄μ£Όμ„Έμ”.');
    WHEN e_discount THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20006, 'ν• μΈκ°€λ” 0.00 ~ 1.00(0% ~ 100%) μ‚¬μ΄μ κ°’μΌλ΅ μ…λ ¥ν•΄μ£Όμ„Έμ”.');        
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'μƒν’ λ“±λ΅μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

### [μƒν’ λ“±λ΅ κ²°κ³Ό]
~~~
-- μƒν’ λ“±λ΅μ‹ μƒμ„Ένμ΄μ§€ λ“±λ΅ν•λ” μµλ… ν”„λ΅μ‹μ €
--------------------
DECLARE
    vp_code product.p_code%TYPE;
BEGIN
    MK_P_PRODUCT('[μ»¤ν”ΌλΉ] λ°”λ‹λΌ λΌλ–Ό νμ°μΉ', 1500, 0, 'λ°”λ‹λΌμ λ¶€λ“λ¬μ΄ λ§¤λ ¥', 2, 1, 'H5', null, SYSDATE, 'C:\admin\marketKurlyProject');
    
    SELECT p_code INTO vp_code
    FROM product
    WHERE p_name = '[μ»¤ν”ΌλΉ] λ°”λ‹λΌ λΌλ–Ό νμ°μΉ';
    
    MK_P_PRODUCTDETAIL(vp_code, 'μ›μ‚°μ§€', 'κµ­λ‚΄μ‚°');
    MK_P_PRODUCTDETAIL(vp_code, 'μ„¤λ…', 'μ»¤ν”ΌλΉμ—μ„ κΎΈμ¤€ν μ‚¬λ‘λ°›μ•„μ¨ μΈκΈ° λ©”λ‰΄, λ°”λ‹λΌ λΌλ–Όλ¥Ό μ»¬λ¦¬μ—μ„ λ§λ‚λ³΄μ„Έμ”....');
    MK_P_PRODUCTDETAIL(vp_code, 'μ•λ λ¥΄κΈ°μ •λ³΄', 'μ°μ , λ€λ‘ ν•¨μ ');
    MK_P_PRODUCTDETAIL(vp_code, 'μμ–‘μ •λ³΄', '[μμ–‘μ •λ³΄ μ΄λ―Έμ§€ νμΌ κ²½λ΅]');
END;
~~~

<img src="images/μƒν’λ“±λ΅.png">
<br>
<img src="images/μƒν’μ΄λ―Έμ§€λ“±λ΅.png">
<br>
<img src="images/μƒν’μƒμ„Ένμ΄μ§€λ“±λ΅.png">
<br><br>

### [μƒν’ λ“±λ΅ κ΄€λ ¨ μμ™Έ κ²°κ³Ό]
<img src="images/μƒν’λ“±λ΅μμ™Έ.png">
<br>
<img src="images/μƒν’μ΄λ―Έμ§€μμ™Έ.png">
<br>
<img src="images/μƒν’μƒμ„Ένμ΄μ§€μμ™Έ.png">

<br><br>

### μΏ ν° λ“±λ΅ / μΏ ν° λ°κΈ‰
- μΏ ν° λ“±λ΅
~~~
1) μΏ ν°μ½”λ“ μ‹ν€€μ¤ μƒμ„±
CREATE SEQUENCE seq_cou_id
INCREMENT BY 1
START WITH 10
NOMAXVALUE
MINVALUE 1
NOCYCLE;

--------------------------------------------------
2) μΏ ν°λ“±λ΅ μ €μ¥ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_coupon
(
    pCOU_NAME coupon.COU_NAME%TYPE
    , pCOU_FUNCTION coupon.COU_FUNCTION%TYPE
    , pCOU_DISCOUNT coupon.COU_DISCOUNT%TYPE
    , pCOU_D_RATE coupon.COU_D_RATE%TYPE
)
IS
    vCOU_DISCOUNT coupon.COU_DISCOUNT%TYPE;
    vCOU_D_RATE coupon.COU_D_RATE%TYPE;
    
    e_cou_discount EXCEPTION;
    e_cou_drate EXCEPTION;
    e_null_coupon EXCEPTION;
    e_coupon EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_null_coupon, -01400);
    
BEGIN   
    IF pCOU_DISCOUNT > 0 AND pCOU_D_RATE BETWEEN 0 AND 1 THEN
        RAISE e_coupon;
    ELSE
        IF pCOU_DISCOUNT >= 0 THEN
            vCOU_DISCOUNT := pCOU_DISCOUNT;
        ELSE
            RAISE e_cou_discount;
        END IF;
        
        IF pCOU_D_RATE BETWEEN 0 AND 1 THEN
            vCOU_D_RATE := pCOU_D_RATE;
        ELSE
            RAISE e_cou_drate;
        END IF;        
    END IF;

    INSERT INTO coupon VALUES(seq_cou_id.nextval, pCOU_NAME, pCOU_FUNCTION, vCOU_DISCOUNT, vCOU_D_RATE);
    COMMIT;
EXCEPTION
    WHEN e_cou_discount THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20005, 'μΏ ν° ν• μΈμ μ©κΈμ•΅μ€ 0μ› μ΄μƒμΌλ΅ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');
    WHEN e_cou_drate THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20006, 'μΏ ν° ν• μΈμ¨μ€ 0.00 ~ 1.00(0% ~ 100%) μ‚¬μ΄μ κ°’μΌλ΅ μ…λ ¥ν•΄μ£Όμ„Έμ”.');
    WHEN e_coupon THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20200, 'μΏ ν° ν• μΈμ¨κ³Ό μΏ ν° ν• μΈμ μ©κΈμ•΅ μ¤‘ ν•λ‚λ§ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');           
    WHEN e_null_coupon THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'μΏ ν° λ“±λ΅μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

- μΏ ν° λ°κΈ‰
~~~
1) λ§μ΄μΏ ν°μ½”λ“ μ‹ν€€μ¤ μƒμ„±
CREATE SEQUENCE seq_mycoupon_code
INCREMENT BY 1
START WITH 7
NOMAXVALUE
MINVALUE 1
NOCYCLE;

--------------------------------------------------
2) λ§μ΄μΏ ν°λ°κΈ‰ν•λ” μ €μ¥ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_mycoupon
(
    pCOU_ID my_coupon.COU_ID%TYPE
    , pC_CODE my_coupon.C_CODE%TYPE
    , pMCOU_END my_coupon.MCOU_END%TYPE
    , pMCOU_CHECK my_coupon.MCOU_CHECK%TYPE
)
IS
    vMCOU_END my_coupon.MCOU_END%TYPE;
    vMCOU_CHECK my_coupon.MCOU_CHECK%TYPE;
    
    e_mcou_end EXCEPTION;
    e_mcou_check EXCEPTION;
    e_no_coupon_code EXCEPTION;
    e_null_mycoupon EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_no_coupon_code, -02291);
    PRAGMA EXCEPTION_INIT (e_null_mycoupon, -01400);
    
BEGIN   
    IF TRUNC(SYSDATE) <= pMCOU_END THEN
        vMCOU_END := pMCOU_END;
    ELSE
        RAISE e_mcou_end;
    END IF;
    
    IF pMCOU_CHECK = 0 THEN
        vMCOU_CHECK := pMCOU_CHECK;
    ELSE
        RAISE e_mcou_check;
    END IF;    
    
    INSERT INTO my_coupon VALUES(seq_mycoupon_code.nextval, pCOU_ID, pC_CODE, vMCOU_END, vMCOU_CHECK);
    COMMIT;
    
EXCEPTION
    WHEN e_no_coupon_code THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'νμ›μ½”λ“ λλ” μΏ ν°μ½”λ“κ°€ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.');
    WHEN e_mcou_end THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20020, 'μΏ ν° μΆ…λ£ μΌμλ” μ¤λλ‚ μ§μ΄κ±°λ‚ λ” μ»¤μ•Όν•©λ‹λ‹¤.');
    WHEN e_mcou_check THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20030, 'μ‚¬μ©κ°€λ¥ν• μΏ ν°μ„ λ°κΈ‰ν•΄μ£Όμ„Έμ”. (μ‚¬μ©κ°€λ¥ 0 μ…λ ¥)');           
    WHEN e_null_mycoupon THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.');
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'μΏ ν° λ°κΈ‰μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

### [μΏ ν° λ“±λ΅ λ° λ°κΈ‰ κ²°κ³Ό]
~~~
EXEC MK_P_COUPON('λ°¥μ€ λ¬µκ³  λ‹¤λ‹λ‚?', 'μ€, μ΅κ³΅ 20% ν• μΈ', 0, 0.2); -- μΏ ν° λ“±λ΅
EXEC MK_P_MYCOUPON (9, 5, '2022.05.10', 0); -- μΏ ν° λ°κΈ‰
~~~

<img src="images/μΏ ν°λ“±λ΅.png">
<br>
<img src="images/μΏ ν°λ°κΈ‰.png">
<br><br>

### [μΏ ν° λ“±λ΅ λ° λ°κΈ‰ μμ™Έ κ²°κ³Ό]
<img src="images/μΏ ν°λ“±λ΅μμ™Έ.png">
<br>
<img src="images/μΏ ν°λ°κΈ‰μμ™Έ.png">
<br><br>

### νΉκ°€, ννƒ λ“±λ΅
~~~
1) νΉκ°€/ννƒ μ½”λ“ μ‹ν€€μ¤ μƒμ„±
CREATE SEQUENCE seq_mk_benefits_code
INCREMENT BY 1
START WITH 5
NOMAXVALUE
MINVALUE 1
NOCYCLE;

--------------------------------------------------
2) νΉκ°€/ννƒ λ“±λ΅ μ €μ¥ ν”„λ΅μ‹μ € μƒμ„±
CREATE OR REPLACE PROCEDURE mk_p_benefits
(
     pB_NAME BENEFITS.B_NAME%TYPE
     , pB_IMGPATH BENEFITS.B_IMGPATH%TYPE
     , pB_START BENEFITS.B_START%TYPE
     , pB_END BENEFITS.B_END%TYPE
     , pMKEMP_NO BENEFITS.MKEMP_NO%TYPE
)
IS
    vB_START BENEFITS.B_START%TYPE;
    vB_END BENEFITS.B_END%TYPE;
    
    e_no_mkemp EXCEPTION;
    e_null_benefits EXCEPTION;
    e_b_start EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_no_mkemp, -02291);
    PRAGMA EXCEPTION_INIT (e_null_benefits, -01400);
BEGIN          
    IF TRUNC(SYSDATE) <= pB_START AND pB_START <= pB_END THEN
        vB_START := pB_START;
        vB_END := pB_END;
    ELSE
        RAISE e_b_start;
    END IF; 
    
    INSERT INTO benefits (B_CODE, B_NAME, B_IMGPATH, B_START, B_END, MKEMP_NO)
    VALUES (seq_mk_benefits_code.nextval, pB_NAME, pB_IMGPATH, vB_START, vB_END, pMKEMP_NO);
    COMMIT;
EXCEPTION
    WHEN e_no_mkemp THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'μ§μ›λ²νΈκ°€ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤.');  -- μ§μ›μ½”λ“ ν™•μΈ
    WHEN e_null_benefits THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20002, 'ν•„μν•­λ©μ„ μ…λ ¥ν•΄ μ£Όμ„Έμ”.'); -- ν•„μμ…λ ¥ μ‚¬ν•­ ν™•μΈ 
    WHEN e_b_start THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20020, 'νΉκ°€/ννƒ μ‹μ‘μΌμ€ μ¤λλ‚ μ§μ΄κ±°λ‚ λ” μ»¤μ•Όν•λ©°, μΆ…λ£μΌμμ™€ κ°™κ±°λ‚ μ‘μ•„μ•Όν•©λ‹λ‹¤.');  
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'νΉκ°€/ννƒ λ“±λ΅μ΄ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

### [νΉκ°€, ννƒ λ“±λ΅ κ²°κ³Ό]
~~~
EXEC MK_P_BENEFITS('5μ›” κ°€μ •μ λ‹¬ μ΄λ²¤νΈ', 'C:\admin\marketKurlyProject', '2022.05.01', '2022.05.30', 1);
~~~
<img src="images/νΉκ°€ννƒλ“±λ΅.png">
<br><br>

### [νΉκ°€, ννƒ λ“±λ΅ μμ™Έ κ²°κ³Ό]
<img src="images/νΉκ°€ννƒλ“±λ΅μμ™Έ.png">
<br><br>

### νμ› νƒν‡΄
- νμ› νƒν‡΄ μ‹ ID, PW, μ£Όμ†, EMAIL, μ΄λ¦„, μƒλ…„μ›”μΌ, μ„±λ³„, μ—°λ½μ²λ¥Ό μ„μμ κ°’μΌλ΅ λ³€κ²½
~~~
CREATE OR REPLACE PROCEDURE mk_p_customer_withdrawal
(
    pC_CODE CUSTOMER.C_CODE%TYPE
)
IS
    vC_CODE CUSTOMER.C_CODE%TYPE;
    v_C_ID CUSTOMER.C_ID%TYPE;
    vNUM NUMBER(1);
    
    e_no_c_code EXCEPTION;    
BEGIN

    SELECT COUNT(*) INTO vNUM
    FROM CUSTOMER
    WHERE C_CODE = pC_CODE;
    
    v_C_ID := 'ννƒ' || TRUNC(DBMS_RANDOM.VALUE(0,9999));
    
    IF vNUM = 1 THEN
        vC_CODE := pC_CODE;
    ELSE
        RAISE e_no_c_code;
    END IF;
 
    UPDATE SIGN_UP
    SET (C_ID, C_PWD, C_ADDRESS, C_EMAIL, C_NAME, C_BIRTHDAY, C_PHONE)
        = (SELECT v_C_ID, 'MARKETKURLYBYE', '-', 'MARKETKURLY@MARKETKURLY.COM', '-', SYSDATE, '010-0000-0000' FROM DUAL)
    WHERE C_CODE = vC_CODE;
    COMMIT; 
    
    UPDATE CUSTOMER
    SET C_NAME ='-', C_ID = v_C_ID, WITHDRAWAL = 1
    WHERE C_CODE = vC_CODE;
    COMMIT;
EXCEPTION
    WHEN e_no_c_code THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20010, 'μ΅΄μ¬ν•μ§€ μ•λ” νμ›μ½”λ“μ…λ‹λ‹¤.');
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20004, 'νμ› νƒν‡΄κ°€ λ¶κ°€λ¥ν•©λ‹λ‹¤.');
END;
~~~

<br>

### [νμ› νƒν‡΄ κ²°κ³Ό]
~~~
EXEC MK_P_CUSTOMER_WITHDRAWAL(6);
~~~
<img src="images/νμ›μ •λ³΄.png">
<br>
<img src="images/νμ›κ°€μ….png">
<br>

<br><br>

## 4. λλ‚€μ 
- μ²μν•΄λ³΄λ” μ¤λΌν΄ ν”„λ΅μ νΈλ΅ DB λ¨λΈλ§μ„ ν•λ” κ²ƒμ΄ μ„ν΄μ—μµλ‹λ‹¤. μ„ν΄μ—λ λ§νΌ μ¤‘κ°„μ— ν…μ΄λΈ”μ— μ»¬λΌμ„ μ¶”κ°€ν•κ³  μ μ•½μ΅°κ±΄μ„ μμ •ν•κ³  μ—¬λ¬ λ² ν…μ¤νΈλ¥Ό ν•λ©΄μ„ μ‹ν€€μ¤λ¥Ό μ‚­μ ν–λ‹¤κ°€ μƒμ„±ν•λ©΄μ„ λ§μ€ μ‹ν–‰ μ°©μ¤λ¥Ό κ²μ—μµλ‹λ‹¤. μ‹ν–‰ μ°©μ¤λ¥Ό κ²μΌλ©΄μ„ ν”„λ΅μ‹μ €λ¥Ό λ§λ“¤κ³  μΏΌλ¦¬λ¥Ό μ§λ©΄μ„ DB λ¨λΈλ§μ΄ μ •λ§ μ¤‘μ”ν•λ‹¤λ” κ²ƒμ„ κΉ¨λ‹¬μ•κ³  μ„¤κ³„λ¥Ό μν•΄μ•Ό νΌνΌν• μ™„μ„± μ‘ν’μ΄ λ‚μ¬ μ μλ‹¤λ” κ²ƒμ„ λκΌμµλ‹λ‹¤. <br>

- μƒν’μ΄λ‚ μΏ ν°, νΉκ°€/ννƒμ„ λ“±λ΅ν•λ” λ¶€λ¶„μ— μμ–΄μ„ μμ™Έμ²λ¦¬ ν•λ” κ²ƒμ΄ μƒκ°λ³΄λ‹¤ λ§μ€ κ²½μ°μ μλ¥Ό μƒκ°ν•΄μ•Ό ν•κ³  μ‘μ€ λ¶€λ¶„μΌλ΅ μ‚¬μ©μκ°€ λ¶νΈν•¨μ„ λλ‚„ μ μμ„ κ±° κ°™λ‹¤κ³  λκΌμµλ‹λ‹¤. <br>

- ν€μ›λΌλ¦¬ μ‹λ„μ§€κ°€ μΆ‹μ•„μ„ μ¦κ²κ² ν”„λ΅μ νΈλ¥Ό μ§„ν–‰ν•  μ μμ—κ³  λ‹¤μ ν”„λ΅μ νΈλ” μ΅°κΈ λ” μν•  μ μλ‹¤λ” μμ‹ κ°μ΄ μƒκ²Όμµλ‹λ‹¤. <br>

- PL/SQLμ— λ€ν•΄μ„ λ” κ³µλ¶€ν•κ³  μ‹¶μ–΄μ΅κ³  λ‹¤μμ—λ” μ£Όλ¬Έ/κ²°μ  ν•λ” λ¶€λ¶„μ„ ν•΄λ³΄κ³  μ‹¶μ–΄ λ„μ „ν•΄λ³΄λ ¤ ν•©λ‹λ‹¤. <br>


